(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},5731:(e,t,s)=>{"use strict";s.d(t,{F:()=>l});let a="http://localhost:8000";!a||a.startsWith("http://")||a.startsWith("https://")||(a="https://".concat(a)),console.log("API_URL:",a),console.log("NEXT_PUBLIC_API_URL:","http://localhost:8000");let r=()=>{let e=localStorage.getItem("token");return e?{Authorization:"Bearer ".concat(e)}:{}},i=async e=>{if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.detail||t.message||"An error occurred")}return e.json()},l={register:async e=>i(await fetch("".concat(a,"/users"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),login:async e=>i(await fetch("".concat(a,"/token"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:e.email,password:e.password})})),getCurrentUser:async()=>i(await fetch("".concat(a,"/users/me"),{headers:r()})),getLaundryTypes:async()=>i(await fetch("".concat(a,"/laundry-types"),{headers:r()})),async getTimeSlots(e){let t=e?"".concat(a,"/time-slots?date=").concat(encodeURIComponent(e)):"".concat(a,"/time-slots");return i(await fetch(t,{headers:r()}))},createPickupRequest:async e=>i(await fetch("".concat(a,"/pickup-requests"),{method:"POST",headers:{"Content-Type":"application/json",...r()},body:JSON.stringify(e)})),getPickupRequests:async()=>i(await fetch("".concat(a,"/pickup-requests"),{headers:r()})),getPickupRequest:async e=>i(await fetch("".concat(a,"/pickup-requests/").concat(e),{headers:r()})),getPaymentMethods:async()=>i(await fetch("".concat(a,"/payment-methods"),{headers:r()})),createPayment:async e=>i(await fetch("".concat(a,"/payments"),{method:"POST",headers:{"Content-Type":"application/json",...r()},body:JSON.stringify(e)})),getPayment:async e=>i(await fetch("".concat(a,"/payments/").concat(e),{headers:r()})),getInvoices:async()=>i(await fetch("".concat(a,"/invoices"),{headers:r()})),getInvoiceByPaymentId:async e=>i(await fetch("".concat(a,"/invoices/payment/").concat(e),{headers:r()})),getInvoice:async e=>i(await fetch("".concat(a,"/invoices/").concat(e),{headers:r()}))}},5964:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(5155),r=s(2115),i=s(5695),l=s(5731);function c(e){let{onDateSelect:t,selectedDate:s}=e,[i,l]=(0,r.useState)([]);return(0,r.useEffect)(()=>{(()=>{let e=new Date,t=[];for(let s=0;s<7;s++){let a=new Date(e);a.setDate(e.getDate()+s);let r="".concat(a.getFullYear(),"-").concat(String(a.getMonth()+1).padStart(2,"0"),"-").concat(String(a.getDate()).padStart(2,"0")),i=a.toLocaleDateString("en-US",{weekday:"short"}),l=a.getDate().toString(),c=0===s;t.push({date:r,day:l,dayName:i,isToday:c,isPast:!1})}l(t)})()},[]),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Pickup Date"}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"})})]}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-2",children:i.map(e=>(0,a.jsxs)("button",{onClick:()=>t(e.date),disabled:e.isPast,className:"\n              p-3 rounded-lg text-center transition-colors\n              ".concat(e.isPast?"bg-gray-100 text-gray-400 cursor-not-allowed":"hover:bg-blue-50 cursor-pointer","\n              ").concat(s===e.date?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-50 text-gray-900","\n              ").concat(e.isToday&&s!==e.date?"ring-2 ring-blue-300":"","\n            "),children:[(0,a.jsx)("div",{className:"text-xs font-medium mb-1",children:e.dayName}),(0,a.jsx)("div",{className:"text-lg font-semibold",children:e.day})]},e.date))}),(0,a.jsx)("div",{className:"mt-4 text-xs text-gray-500 text-center",children:"Select a date to see available time slots"})]})}function d(e){let t,{onSuccess:s}=e,[i,d]=(0,r.useState)(1),[n,o]=(0,r.useState)([]),[x,m]=(0,r.useState)([]),[u,h]=(0,r.useState)([]),[p,g]=(0,r.useState)(""),[y,b]=(0,r.useState)({address:{street:"",city:"",state:"",zip_code:"",instructions:""},time_slot_id:"",service_type_ids:[],service_items:{},special_instructions:"",payment_method_id:""}),[j,f]=(0,r.useState)(!1),[N,v]=(0,r.useState)(""),w={regular:[{id:"tshirt",name:"T-Shirt",price:25},{id:"shirt",name:"Shirt",price:35},{id:"jeans",name:"Jeans",price:45},{id:"lowers",name:"Lowers/Pants",price:40},{id:"underwear",name:"Underwear",price:15},{id:"socks",name:"Socks",price:10}],bag:[{id:"small_bag",name:"Small Bag (up to 5kg)",price:150},{id:"medium_bag",name:"Medium Bag (up to 8kg)",price:200},{id:"large_bag",name:"Large Bag (up to 10kg)",price:249.9}],shoes:[{id:"sneakers",name:"Sneakers",price:80},{id:"formal_shoes",name:"Formal Shoes",price:90},{id:"boots",name:"Boots",price:100},{id:"sandals",name:"Sandals",price:60}],blanket:[{id:"single_blanket",name:"Single Blanket",price:120},{id:"double_blanket",name:"Double Blanket",price:180},{id:"comforter",name:"Comforter",price:199.9},{id:"duvet",name:"Duvet",price:220}],dry_cleaning:[{id:"suit",name:"Suit (2-piece)",price:200},{id:"dress",name:"Dress",price:150},{id:"coat",name:"Coat/Jacket",price:180},{id:"saree",name:"Saree",price:120},{id:"curtains",name:"Curtains",price:100}],ironing:[{id:"tshirt_iron",name:"T-Shirt",price:15},{id:"shirt_iron",name:"Shirt",price:20},{id:"jeans_iron",name:"Jeans",price:25},{id:"dress_iron",name:"Dress",price:30},{id:"saree_iron",name:"Saree",price:40}]};(0,r.useEffect)(()=>{(async()=>{try{let[e,t]=await Promise.all([l.F.getLaundryTypes(),l.F.getPaymentMethods()]);o(e),h(t)}catch(e){console.error("Error fetching form data:",e)}})()},[]),(0,r.useEffect)(()=>{(async()=>{if(p)try{console.log("Fetching time slots for date:",p);let e=await l.F.getTimeSlots(p);console.log("Received time slots:",e),m(e)}catch(e){console.error("Error fetching time slots:",e)}else m([])})()},[p]);let k=x.find(e=>e.id===y.time_slot_id);n.filter(e=>y.service_type_ids.includes(e.id));let _=u.find(e=>e.id===y.payment_method_id),S=(t=0,Object.entries(y.service_items).forEach(e=>{let[s,a]=e,r=w[s]||[];Object.entries(a).forEach(e=>{let[s,a]=e,i=r.find(e=>e.id===s);i&&a>0&&(t+=i.price*a)})}),t),C=(e,t,s)=>{var a;console.log("Updating quantity for ".concat(e,"-").concat(t," by ").concat(s));let r=(null==(a=y.service_items[e])?void 0:a[t])||0,i=Math.max(0,r+s);console.log("Current: ".concat(r,", New: ").concat(i));let l={...y.service_items};l[e]||(l[e]={}),0===i?(delete l[e][t],0===Object.keys(l[e]).length&&delete l[e]):l[e][t]=i,b({...y,service_items:l})},P=e=>{let t=y.service_items[e];return t&&Object.values(t).some(e=>e>0)};(0,r.useEffect)(()=>{if(6===i&&!N){let e=setTimeout(()=>s(),3e3);return()=>clearTimeout(e)}},[i,s,N]);let D=()=>{d(i+1)},O=()=>{d(i-1)},I=async()=>{f(!0);try{let e={address:y.address,time_slot_id:y.time_slot_id,service_type_ids:y.service_type_ids,service_items:y.service_items,special_instructions:y.special_instructions},t=await l.F.createPickupRequest(e);v(t.id),d(5)}catch(e){console.error("Error creating pickup request:",e),alert("Failed to create pickup request. Please try again.")}finally{f(!1)}},T=async()=>{if(0!==S&&N){f(!0);try{let e=await l.F.createPayment({pickup_request_id:N,payment_method_id:y.payment_method_id,amount:1.08*S}),t=await l.F.getInvoiceByPaymentId(e.id);d(6),setTimeout(()=>{window.location.href="/invoice/".concat(t.id)},3e3)}catch(e){console.error("Error processing payment:",e),alert("Failed to process payment. Please try again.")}finally{f(!1)}}};return(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 text-center mb-8",children:"Schedule Laundry Pickup"}),i<=3&&(0,a.jsx)(()=>(0,a.jsx)("div",{className:"flex items-center justify-center mb-8",children:[1,2,3].map(e=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-medium ".concat(i>=e?"bg-blue-600":"bg-gray-300"),children:e}),(0,a.jsxs)("div",{className:"ml-3 text-sm font-medium ".concat(i>=e?"text-blue-600":"text-gray-400"),children:[1===e&&"Address",2===e&&"Pickup Time",3===e&&"Service Type"]}),e<3&&(0,a.jsx)("div",{className:"mx-4 w-16 h-0.5 bg-gray-300"})]},e))}),{}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2",children:[1===i&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Pickup Address"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street Address"}),(0,a.jsx)("input",{type:"text",required:!0,value:y.address.street,onChange:e=>b({...y,address:{...y.address,street:e.target.value}}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"123 Main St"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Apartment, Suite, etc. (Optional)"}),(0,a.jsx)("input",{type:"text",value:y.address.instructions||"",onChange:e=>b({...y,address:{...y.address,instructions:e.target.value}}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Apt #123"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),(0,a.jsx)("input",{type:"text",required:!0,value:y.address.city,onChange:e=>b({...y,address:{...y.address,city:e.target.value}}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"New York"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),(0,a.jsx)("input",{type:"text",required:!0,value:y.address.state,onChange:e=>b({...y,address:{...y.address,state:e.target.value}}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"NY"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ZIP Code"}),(0,a.jsx)("input",{type:"text",required:!0,value:y.address.zip_code,onChange:e=>b({...y,address:{...y.address,zip_code:e.target.value}}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"10001"})]}),(0,a.jsx)("div",{className:"flex justify-end pt-6",children:(0,a.jsx)("button",{onClick:D,disabled:!y.address.street||!y.address.city||!y.address.state||!y.address.zip_code,className:"bg-blue-600 text-white px-8 py-3 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Continue"})})]})]}),2===i&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Select Pickup Time"}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(c,{onDateSelect:e=>{console.log("Selected date:",e),g(e),b({...y,time_slot_id:""})},selectedDate:p})}),p&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Available Time Slots"}),x.length>0?(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:x.map(e=>(0,a.jsxs)("button",{onClick:()=>b({...y,time_slot_id:e.id}),className:"p-4 rounded-lg border-2 transition-all duration-200 text-center ".concat(y.time_slot_id===e.id?"border-blue-500 bg-blue-50 text-blue-700 shadow-md":"border-gray-200 bg-white hover:border-blue-300 hover:bg-blue-50 text-gray-700"),children:[(0,a.jsx)("div",{className:"text-lg font-semibold",children:e.time}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Available"})]},e.id))}):(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,a.jsx)("p",{children:"No time slots available for this date."})})]}),!p&&(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,a.jsx)("p",{children:"Please select a date to see available time slots."})}),(0,a.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,a.jsx)("button",{onClick:O,className:"bg-gray-300 text-gray-700 px-8 py-3 rounded-lg font-medium hover:bg-gray-400",children:"Back"}),(0,a.jsx)("button",{onClick:D,disabled:!y.time_slot_id,className:"bg-blue-600 text-white px-8 py-3 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Continue"})]})]}),3===i&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Select Laundry Services"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Select items and quantities for your pickup"}),(0,a.jsx)("div",{className:"space-y-6 mb-6",children:n.map(e=>{let t=y.service_type_ids.includes(e.id),s=P(e.id),r=w[e.id]||[],i=()=>{t?b(t=>{let s={...t.service_items};return delete s[e.id],{...t,service_type_ids:t.service_type_ids.filter(t=>t!==e.id),service_items:s}}):b(t=>({...t,service_type_ids:[...t.service_type_ids,e.id]}))};return(0,a.jsxs)("div",{className:"border rounded-lg transition-colors ".concat(t||s?"border-blue-500 bg-blue-50":"border-gray-300"),children:[(0,a.jsx)("div",{className:"p-6 cursor-pointer",onClick:i,children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:t,onChange:e=>{e.stopPropagation(),i()},onClick:e=>e.stopPropagation(),className:"mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[s&&(0,a.jsxs)("p",{className:"text-sm text-blue-600 font-medium",children:[Object.values(y.service_items[e.id]||{}).reduce((e,t)=>e+t,0)," items"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Starting from ₹",Math.min(...r.map(e=>e.price))]})]})]})}),t&&(0,a.jsxs)("div",{className:"border-t bg-white p-6",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-4",children:"Select Items:"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(t=>{var s;let r=(null==(s=y.service_items[e.id])?void 0:s[t.id])||0;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-gray-50",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:t.name}),(0,a.jsxs)("p",{className:"text-sm text-blue-600",children:["₹",t.price," each"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:s=>{s.preventDefault(),s.stopPropagation(),C(e.id,t.id,-1)},disabled:0===r,className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:"-"}),(0,a.jsx)("span",{className:"w-8 text-center font-medium text-gray-900",children:r}),(0,a.jsx)("button",{type:"button",onClick:s=>{s.preventDefault(),s.stopPropagation(),C(e.id,t.id,1)},className:"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white hover:bg-blue-700",children:"+"})]})]},t.id)})})]})]},e.id)})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Special Instructions (Optional)"}),(0,a.jsx)("textarea",{value:y.special_instructions,onChange:e=>b({...y,special_instructions:e.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Any special instructions for handling your laundry..."})]}),(0,a.jsxs)("div",{className:"flex justify-between pt-6",children:[(0,a.jsx)("button",{onClick:O,className:"bg-gray-300 text-gray-700 px-8 py-3 rounded-lg font-medium hover:bg-gray-400",children:"Back"}),(0,a.jsx)("button",{onClick:I,disabled:0===S||j,className:"bg-blue-600 text-white px-8 py-3 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:j?"Creating...":"Continue to Payment"})]})]}),5===i&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"Payment Details"}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Payment Method"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:u.map(e=>(0,a.jsxs)("div",{className:"border rounded-lg p-4 cursor-pointer transition-colors ".concat(y.payment_method_id===e.id?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"),onClick:()=>b({...y,payment_method_id:e.id}),children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("input",{type:"radio",checked:y.payment_method_id===e.id,onChange:()=>b({...y,payment_method_id:e.id}),className:"mr-3"}),(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.name})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]},e.id))})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Summary"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Pickup Address:"}),(0,a.jsxs)("span",{className:"text-gray-900 text-right",children:[y.address.street,", ",y.address.city,", ",y.address.state," ",y.address.zip_code]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Pickup Time:"}),(0,a.jsxs)("span",{className:"text-gray-900",children:[null==k?void 0:k.display_date,", ",null==k?void 0:k.time]})]}),(0,a.jsxs)("div",{className:"border-t pt-3",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Items:"}),Object.entries(y.service_items).map(e=>{let[t,s]=e,r=n.find(e=>e.id===t),i=w[t]||[];return(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("p",{className:"text-xs font-medium text-gray-600 mb-1",children:[null==r?void 0:r.name,":"]}),Object.entries(s).map(e=>{let[t,s]=e,r=i.find(e=>e.id===t);return r&&0!==s?(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm ml-2",children:[(0,a.jsxs)("span",{className:"text-gray-700",children:[r.name," \xd7 ",s]}),(0,a.jsxs)("span",{className:"text-gray-900",children:["₹",(r.price*s).toFixed(2)]})]},t):null})]},t)})]}),(0,a.jsxs)("div",{className:"border-t pt-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Subtotal:"}),(0,a.jsxs)("span",{className:"text-gray-900",children:["₹",S.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Tax (8%):"}),(0,a.jsxs)("span",{className:"text-gray-900",children:["₹",(.08*S).toFixed(2)]})]}),(0,a.jsx)("div",{className:"border-t pt-2 mt-2",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"text-lg font-semibold text-gray-900",children:"Total:"}),(0,a.jsxs)("span",{className:"text-lg font-semibold text-blue-600",children:["₹",(1.08*S).toFixed(2)]})]})})]})]})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("button",{onClick:T,disabled:!y.payment_method_id||j,className:"bg-blue-600 text-white px-12 py-4 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-lg",children:j?"Processing...":"Confirm Request & Generate Invoice"})})]}),6===i&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,a.jsx)("svg",{className:"w-10 h-10 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),(0,a.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Request Confirmed!"}),(0,a.jsxs)("p",{className:"text-gray-600 mb-8",children:["Your pickup request has been confirmed. ",(null==_?void 0:_.name)==="Cash"?"You will pay on delivery.":"Payment has been processed."]}),(0,a.jsx)("p",{className:"text-gray-500 mb-8",children:"Redirecting to your invoice..."}),(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"})]})]}),i<=3&&(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsx)(()=>(0,a.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Order Summary"}),y.address.street&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Pickup Address:"}),(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[y.address.street,", ",y.address.city,", ",y.address.state," ",y.address.zip_code]})]}),k&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Pickup Time:"}),(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:[k.display_date,", ",k.time]})]}),Object.keys(y.service_items).length>0&&(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Selected Items:"}),(0,a.jsx)("div",{className:"space-y-2",children:Object.entries(y.service_items).map(e=>{let[t,s]=e,r=n.find(e=>e.id===t),i=w[t]||[];return(0,a.jsxs)("div",{className:"border-l-2 border-blue-200 pl-3",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-700 mb-1",children:null==r?void 0:r.name}),Object.entries(s).map(e=>{let[t,s]=e,r=i.find(e=>e.id===t);return r&&0!==s?(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsxs)("span",{className:"text-gray-900",children:[r.name," \xd7 ",s]}),(0,a.jsxs)("span",{className:"text-blue-600",children:["₹",(r.price*s).toFixed(2)]})]},t):null})]},t)})}),(0,a.jsx)("div",{className:"border-t pt-2 mt-2",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("p",{className:"text-sm font-bold text-gray-900",children:"Total:"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-blue-600",children:["₹",S.toFixed(2)]})]})})]})]}),{})})]})]})}function n(){var e;let t=(0,i.useRouter)(),[s,c]=(0,r.useState)(null),[n,o]=(0,r.useState)([]),[x,m]=(0,r.useState)([]),[u,h]=(0,r.useState)(!0),[p,g]=(0,r.useState)("dashboard");(0,r.useEffect)(()=>{if(!localStorage.getItem("token"))return void t.push("/login");(async()=>{try{let e=await l.F.getCurrentUser(),t=await l.F.getPickupRequests(),s=await l.F.getInvoices();c(e),o(t),m(s),h(!1)}catch(e){console.error("Error fetching data:",e),localStorage.removeItem("token"),t.push("/login")}})()},[t]);let y=n.filter(e=>"pending"===e.status||"confirmed"===e.status||"paid"===e.status).length,b=n.filter(e=>"completed"===e.status).length,j=x.reduce((e,t)=>e+t.amount,0),f=()=>{localStorage.removeItem("token"),t.push("/")};return u?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("nav",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-blue-600",children:"Laundry Service"}),(0,a.jsxs)("div",{className:"flex space-x-8",children:[(0,a.jsx)("button",{onClick:()=>g("dashboard"),className:"px-3 py-2 text-sm font-medium border-b-2 ".concat("dashboard"===p?"text-blue-600 border-blue-600":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"),children:"Dashboard"}),(0,a.jsx)("button",{onClick:()=>g("schedule"),className:"px-3 py-2 text-sm font-medium border-b-2 ".concat("schedule"===p?"text-blue-600 border-blue-600":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"),children:"Schedule Pickup"}),(0,a.jsx)("button",{onClick:()=>g("orders"),className:"px-3 py-2 text-sm font-medium border-b-2 ".concat("orders"===p?"text-blue-600 border-blue-600":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"),children:"My Orders"}),(0,a.jsx)("button",{onClick:()=>g("invoices"),className:"px-3 py-2 text-sm font-medium border-b-2 ".concat("invoices"===p?"text-blue-600 border-blue-600":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"),children:"Invoices"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-700",children:["Hello, ",(null==s?void 0:s.full_name)||"test4"]}),(0,a.jsx)("button",{onClick:f,className:"text-sm text-gray-500 hover:text-gray-700",children:"Logout"})]})]})})}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"w-80 bg-white shadow-sm min-h-screen",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-gray-300 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("span",{className:"text-2xl font-semibold text-gray-600",children:(null==s||null==(e=s.full_name)?void 0:e.charAt(0))||"t"})}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:(null==s?void 0:s.full_name)||"test4"}),(0,a.jsx)("p",{className:"text-gray-600 text-sm",children:(null==s?void 0:s.email)||"test4@test.com"})]}),(0,a.jsxs)("nav",{className:"space-y-2",children:[(0,a.jsx)("button",{onClick:()=>g("dashboard"),className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors ".concat("dashboard"===p?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Dashboard"}),(0,a.jsx)("button",{onClick:()=>g("schedule"),className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors ".concat("schedule"===p?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Schedule Pickup"}),(0,a.jsx)("button",{onClick:()=>g("orders"),className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors ".concat("orders"===p?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Order History"}),(0,a.jsx)("button",{onClick:()=>g("profile"),className:"w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors ".concat("profile"===p?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"),children:"Profile Settings"})]})]})}),(0,a.jsxs)("div",{className:"flex-1 p-8",children:["dashboard"===p&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["Welcome, ",(null==s?void 0:s.full_name)||"test4"]}),(0,a.jsx)("button",{onClick:f,className:"text-sm text-gray-500 hover:text-gray-700",children:"Logout"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-6 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-blue-600 mb-2",children:"Active Orders"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-blue-700",children:y})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-6 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-green-600 mb-2",children:"Completed Orders"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-green-700",children:b})]}),(0,a.jsxs)("div",{className:"bg-purple-50 p-6 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-purple-600 mb-2",children:"Total Spent"}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-purple-700",children:["₹",j.toFixed(2)]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Recent Orders"}),(0,a.jsx)("button",{onClick:()=>g("schedule"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700",children:"Schedule New Pickup"})]}),0===n.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"You haven't placed any orders yet."}),(0,a.jsx)("button",{onClick:()=>g("schedule"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700",children:"Schedule Your First Pickup"})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Address"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:n.slice(0,5).map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",e.id.slice(-6)]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("completed"===e.status?"bg-green-100 text-green-800":"paid"===e.status?"bg-blue-100 text-blue-800":"confirmed"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.address.street,", ",e.address.city]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsx)("button",{onClick:()=>g("invoices"),className:"text-blue-600 hover:text-blue-900",children:"View"})})]},e.id))})]})})]})]}),"schedule"===p&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-8",children:"Schedule Pickup"}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,a.jsx)(d,{onSuccess:()=>{g("orders"),(async()=>{try{let e=await l.F.getPickupRequests(),t=await l.F.getInvoices();o(e),m(t)}catch(e){console.error("Error refreshing data:",e)}})()}})})]}),"orders"===p&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-8",children:"My Orders"}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:0===n.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"No orders found."}),(0,a.jsx)("button",{onClick:()=>g("schedule"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700",children:"Schedule Your First Pickup"})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date Created"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Address"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time Slot"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Instructions"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",e.id.slice(-6)]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("completed"===e.status?"bg-green-100 text-green-800":"paid"===e.status?"bg-blue-100 text-blue-800":"confirmed"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:e.address.street}),(0,a.jsxs)("div",{children:[e.address.city,", ",e.address.state," ",e.address.zip_code]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.time_slot_id}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.special_instructions||"None"}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,a.jsx)("button",{onClick:()=>g("invoices"),className:"text-blue-600 hover:text-blue-900 mr-2",children:"View"}),"pending"===e.status&&(0,a.jsx)("button",{className:"text-red-600 hover:text-red-900",children:"Cancel"})]})]},e.id))})]})})})]}),"invoices"===p&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-8",children:"Invoices"}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:0===x.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"No invoices found."}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Invoices will appear here after you complete orders."})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Invoice ID"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estimated Delivery"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:["#",e.id.slice(-6)]}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["#",e.pickup_request_id.slice(-6)]}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium",children:["₹",e.amount.toFixed(2)]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("paid"===e.status?"bg-green-100 text-green-800":"issued"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.estimated_delivery).toLocaleDateString()}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,a.jsx)("button",{onClick:()=>window.open("/invoice/".concat(e.id),"_blank"),className:"text-blue-600 hover:text-blue-900 mr-2",children:"Download"}),(0,a.jsx)("button",{onClick:()=>window.location.href="/invoice/".concat(e.id),className:"text-green-600 hover:text-green-900",children:"View"})]})]},e.id))})]})})})]}),"profile"===p&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-8",children:"Profile Settings"}),(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:(0,a.jsx)("p",{className:"text-gray-600",children:"Profile settings will go here..."})})]})]})]})]})}},7870:(e,t,s)=>{Promise.resolve().then(s.bind(s,5964))}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(7870)),_N_E=e.O()}]);